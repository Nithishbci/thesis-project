{"filter":false,"title":"deploy-eb.yml","tooltip":"/.github/workflows/deploy-eb.yml","undoManager":{"mark":8,"position":8,"stack":[[{"start":{"row":0,"column":0},"end":{"row":52,"column":0},"action":"insert","lines":["name: Deploy Flask App to Elastic Beanstalk","","on:","  push:","    branches: [\"main\"]","","jobs:","  deploy:","    runs-on: ubuntu-latest","","    steps:","    - name: Checkout repository","      uses: actions/checkout@v3","","    - name: Set up Python","      uses: actions/setup-python@v4","      with:","        python-version: \"3.9\"","","    - name: Install dependencies","      run: |","        python -m pip install --upgrade pip","        pip install -r requirements.txt","","    - name: Zip application","      run: |","        zip -r app.zip . -x \"*.git*\"","","    - name: Configure AWS Credentials","      uses: aws-actions/configure-aws-credentials@v2","      with:","        aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}","        aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}","        aws-region: ${{ secrets.AWS_REGION }}","","    - name: Upload new version to Elastic Beanstalk","      run: |","        aws elasticbeanstalk create-application-version \\","          --application-name \"${{ secrets.EB_APP_NAME }}\" \\","          --version-label \"build-${{ github.run_number }}\" \\","          --source-bundle S3Bucket=\"elasticbeanstalk-${{ secrets.AWS_REGION }}-${{ secrets.AWS_ACCESS_KEY_ID }}\",S3Key=\"app-${{ github.run_number }}.zip\"","","    - name: Upload ZIP to S3","      run: |","        aws s3 cp app.zip \\","        s3://elasticbeanstalk-${{ secrets.AWS_REGION }}-${{ secrets.AWS_ACCESS_KEY_ID }}/app-${{ github.run_number }}.zip","","    - name: Deploy application version","      run: |","        aws elasticbeanstalk update-environment \\","          --environment-name \"${{ secrets.EB_ENV_NAME }}\" \\","          --version-label \"build-${{ github.run_number }}\"",""],"id":11}],[{"start":{"row":0,"column":0},"end":{"row":52,"column":0},"action":"remove","lines":["name: Deploy Flask App to Elastic Beanstalk","","on:","  push:","    branches: [\"main\"]","","jobs:","  deploy:","    runs-on: ubuntu-latest","","    steps:","    - name: Checkout repository","      uses: actions/checkout@v3","","    - name: Set up Python","      uses: actions/setup-python@v4","      with:","        python-version: \"3.9\"","","    - name: Install dependencies","      run: |","        python -m pip install --upgrade pip","        pip install -r requirements.txt","","    - name: Zip application","      run: |","        zip -r app.zip . -x \"*.git*\"","","    - name: Configure AWS Credentials","      uses: aws-actions/configure-aws-credentials@v2","      with:","        aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}","        aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}","        aws-region: ${{ secrets.AWS_REGION }}","","    - name: Upload new version to Elastic Beanstalk","      run: |","        aws elasticbeanstalk create-application-version \\","          --application-name \"${{ secrets.EB_APP_NAME }}\" \\","          --version-label \"build-${{ github.run_number }}\" \\","          --source-bundle S3Bucket=\"elasticbeanstalk-${{ secrets.AWS_REGION }}-${{ secrets.AWS_ACCESS_KEY_ID }}\",S3Key=\"app-${{ github.run_number }}.zip\"","","    - name: Upload ZIP to S3","      run: |","        aws s3 cp app.zip \\","        s3://elasticbeanstalk-${{ secrets.AWS_REGION }}-${{ secrets.AWS_ACCESS_KEY_ID }}/app-${{ github.run_number }}.zip","","    - name: Deploy application version","      run: |","        aws elasticbeanstalk update-environment \\","          --environment-name \"${{ secrets.EB_ENV_NAME }}\" \\","          --version-label \"build-${{ github.run_number }}\"",""],"id":12},{"start":{"row":0,"column":0},"end":{"row":42,"column":0},"action":"insert","lines":["name: Deploy Flask App to Elastic Beanstalk","","on:","  push:","    branches: [\"main\"]","","jobs:","  deploy:","      runs-on: ubuntu-latest","      needs: build_and_test","    ","      steps:","        - name: Download artifact","          uses: actions/download-artifact@v4","          with:","            name: deploy-package","    ","        # ---------------------------------------------------------","        # Correct AWS Credentials Configuration","        # ---------------------------------------------------------","        - name: Configure AWS Credentials","          uses: aws-actions/configure-aws-credentials@v4","          with:","            aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}","            aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}","            aws-region: us-east-1","    ","        # ---------------------------------------------------------","        # Deploy to Elastic Beanstalk","        # ---------------------------------------------------------","        - name: Deploy to Elastic Beanstalk","          uses: einaregilsson/beanstalk-deploy@v21","          with:","            aws_access_key: ${{ secrets.AWS_ACCESS_KEY_ID }}","            aws_secret_key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}","            application_name: Devops-x23300841-eb","            environment_name: Devops-x23300841-eb-env","            version_label: \"build-${{ github.run_number }}\"","            region: us-east-1","            deployment_package: deploy.zip","            wait_for_deployment: true","",""]}],[{"start":{"row":0,"column":0},"end":{"row":42,"column":0},"action":"remove","lines":["name: Deploy Flask App to Elastic Beanstalk","","on:","  push:","    branches: [\"main\"]","","jobs:","  deploy:","      runs-on: ubuntu-latest","      needs: build_and_test","    ","      steps:","        - name: Download artifact","          uses: actions/download-artifact@v4","          with:","            name: deploy-package","    ","        # ---------------------------------------------------------","        # Correct AWS Credentials Configuration","        # ---------------------------------------------------------","        - name: Configure AWS Credentials","          uses: aws-actions/configure-aws-credentials@v4","          with:","            aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}","            aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}","            aws-region: us-east-1","    ","        # ---------------------------------------------------------","        # Deploy to Elastic Beanstalk","        # ---------------------------------------------------------","        - name: Deploy to Elastic Beanstalk","          uses: einaregilsson/beanstalk-deploy@v21","          with:","            aws_access_key: ${{ secrets.AWS_ACCESS_KEY_ID }}","            aws_secret_key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}","            application_name: Devops-x23300841-eb","            environment_name: Devops-x23300841-eb-env","            version_label: \"build-${{ github.run_number }}\"","            region: us-east-1","            deployment_package: deploy.zip","            wait_for_deployment: true","",""],"id":13},{"start":{"row":0,"column":0},"end":{"row":34,"column":0},"action":"insert","lines":["name: Deploy Flask App to Elastic Beanstalk","","on:","  push:","    branches: [\"main\"]","","jobs:","  deploy:","    runs-on: ubuntu-latest","    ","    steps:","      - name: Download artifact","        uses: actions/download-artifact@v4","        with:","          name: deploy-package","","      - name: Configure AWS Credentials","        uses: aws-actions/configure-aws-credentials@v4","        with:","          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}","          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}","          aws-region: us-east-1","","      - name: Deploy to Elastic Beanstalk","        uses: einaregilsson/beanstalk-deploy@v21","        with:","          aws_access_key: ${{ secrets.AWS_ACCESS_KEY_ID }}","          aws_secret_key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}","          application_name: Devops-x23300841-eb","          environment_name: Devops-x23300841-eb-env","          version_label: \"build-${{ github.run_number }}\"","          region: us-east-1","          deployment_package: deploy.zip","          wait_for_deployment: true",""]}],[{"start":{"row":0,"column":0},"end":{"row":34,"column":0},"action":"remove","lines":["name: Deploy Flask App to Elastic Beanstalk","","on:","  push:","    branches: [\"main\"]","","jobs:","  deploy:","    runs-on: ubuntu-latest","    ","    steps:","      - name: Download artifact","        uses: actions/download-artifact@v4","        with:","          name: deploy-package","","      - name: Configure AWS Credentials","        uses: aws-actions/configure-aws-credentials@v4","        with:","          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}","          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}","          aws-region: us-east-1","","      - name: Deploy to Elastic Beanstalk","        uses: einaregilsson/beanstalk-deploy@v21","        with:","          aws_access_key: ${{ secrets.AWS_ACCESS_KEY_ID }}","          aws_secret_key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}","          application_name: Devops-x23300841-eb","          environment_name: Devops-x23300841-eb-env","          version_label: \"build-${{ github.run_number }}\"","          region: us-east-1","          deployment_package: deploy.zip","          wait_for_deployment: true",""],"id":14},{"start":{"row":0,"column":0},"end":{"row":156,"column":0},"action":"insert","lines":["name: Django CI/CD to Elastic Beanstalk","","on:","  push:","    branches:","      - main","","jobs:","","  # ============================================================","  # 1️⃣ PREBUILD STAGE","  # ============================================================","  prebuild:","    runs-on: ubuntu-latest","","    steps:","      - name: Checkout repo","        uses: actions/checkout@v3","","      - name: Set up Python","        uses: actions/setup-python@v4","        with:","          python-version: \"3.11\"","","      - name: Install dependencies","        run: |","          pip install --upgrade pip","          pip install -r requirements.txt","","      - name: Install OS dependencies","        run: |","          sudo apt-get update","          sudo apt-get install -y jq unzip wget","","      - name: Install Java 17 (Amazon Corretto)","        run: |","          wget https://corretto.aws/downloads/latest/amazon-corretto-17-x64-linux-jdk.deb","          sudo dpkg -i amazon-corretto-17-x64-linux-jdk.deb","          java --version","","","  # ============================================================","  # 2️⃣ BUILD + TEST STAGE","  # ============================================================","  build_and_test:","    runs-on: ubuntu-latest","    needs: prebuild","","    steps:","      - uses: actions/checkout@v3","","      - uses: actions/setup-python@v4","        with:","          python-version: \"3.11\"","","      - name: Install project dependencies","        run: |","          pip install --upgrade pip","          pip install -r requirements.txt","          pip install pylint","","      - name: Run collectstatic","        run: |","          python manage.py collectstatic --noinput","","      - name: Pylint","        continue-on-error: true","        run: pylint . || true","","      - name: Run Django Tests","        run: python manage.py test || true","","","  # ============================================================","  # 3️⃣ SONAR SCAN STAGE","  # ============================================================","  sonar_scan:","    runs-on: ubuntu-latest","    needs: build_and_test","","    steps:","      - uses: actions/checkout@v3","","      - name: Install Sonar Scanner","        run: |","          wget https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-5.0.1.3006-linux.zip","          unzip sonar-scanner-cli-5.0.1.3006-linux.zip","          mv sonar-scanner-5.0.1.3006-linux sonar-scanner","          echo \"${{ github.workspace }}/sonar-scanner/bin\" >> $GITHUB_PATH","","      - name: Run SonarCloud Scan","        env:","          SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}","          SONAR_PROJECT_KEY: ${{ secrets.SONAR_PROJECT_KEY }}","          SONAR_ORG: ${{ secrets.SONAR_ORG }}","        run: |","          sonar-scanner \\","            -Dsonar.login=$SONAR_TOKEN \\","            -Dsonar.host.url=https://sonarcloud.io \\","            -Dsonar.projectKey=$SONAR_PROJECT_KEY \\","            -Dsonar.organization=$SONAR_ORG \\","            -Dsonar.coverage.exclusions=**/* || true","","","  # ============================================================","  # 4️⃣ PACKAGE ARTIFACT","  # ============================================================","  package:","    runs-on: ubuntu-latest","    needs: sonar_scan","","    steps:","      - uses: actions/checkout@v3","","      - name: Create ZIP for Elastic Beanstalk","        run: |","          zip -r deploy.zip . -x \"*.git*\" \".github/*\"","","      - name: Upload artifact","        uses: actions/upload-artifact@v4","        with:","          name: deploy-package","          path: deploy.zip","","","  # ============================================================","  # 5️⃣ DEPLOY TO ELASTIC BEANSTALK","  # ============================================================","  deploy:","    runs-on: ubuntu-latest","    needs: package","","    steps:","      - name: Download artifact","        uses: actions/download-artifact@v4","        with:","          name: deploy-package","","      - name: Configure AWS Credentials","        uses: aws-actions/configure-aws-credentials@v4","        with:","          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}","          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}","          aws-region: us-east-1","","      - name: Deploy to Elastic Beanstalk","        uses: einaregilsson/beanstalk-deploy@v21","        with:","          aws_access_key: ${{ secrets.AWS_ACCESS_KEY_ID }}","          aws_secret_key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}","          application_name: Devops-x23300841-eb","          environment_name: Devops-x23300841-eb-env","          region: us-east-1","          deployment_package: deploy.zip","          version_label: \"build-${{ github.run_number }}\"","          wait_for_deployment: true",""]}],[{"start":{"row":72,"column":0},"end":{"row":102,"column":0},"action":"remove","lines":["","  # ============================================================","  # 3️⃣ SONAR SCAN STAGE","  # ============================================================","  sonar_scan:","    runs-on: ubuntu-latest","    needs: build_and_test","","    steps:","      - uses: actions/checkout@v3","","      - name: Install Sonar Scanner","        run: |","          wget https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-5.0.1.3006-linux.zip","          unzip sonar-scanner-cli-5.0.1.3006-linux.zip","          mv sonar-scanner-5.0.1.3006-linux sonar-scanner","          echo \"${{ github.workspace }}/sonar-scanner/bin\" >> $GITHUB_PATH","","      - name: Run SonarCloud Scan","        env:","          SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}","          SONAR_PROJECT_KEY: ${{ secrets.SONAR_PROJECT_KEY }}","          SONAR_ORG: ${{ secrets.SONAR_ORG }}","        run: |","          sonar-scanner \\","            -Dsonar.login=$SONAR_TOKEN \\","            -Dsonar.host.url=https://sonarcloud.io \\","            -Dsonar.projectKey=$SONAR_PROJECT_KEY \\","            -Dsonar.organization=$SONAR_ORG \\","            -Dsonar.coverage.exclusions=**/* || true",""],"id":15}],[{"start":{"row":40,"column":0},"end":{"row":72,"column":0},"action":"remove","lines":["","  # ============================================================","  # 2️⃣ BUILD + TEST STAGE","  # ============================================================","  build_and_test:","    runs-on: ubuntu-latest","    needs: prebuild","","    steps:","      - uses: actions/checkout@v3","","      - uses: actions/setup-python@v4","        with:","          python-version: \"3.11\"","","      - name: Install project dependencies","        run: |","          pip install --upgrade pip","          pip install -r requirements.txt","          pip install pylint","","      - name: Run collectstatic","        run: |","          python manage.py collectstatic --noinput","","      - name: Pylint","        continue-on-error: true","        run: pylint . || true","","      - name: Run Django Tests","        run: python manage.py test || true","",""],"id":16}],[{"start":{"row":33,"column":0},"end":{"row":38,"column":24},"action":"remove","lines":["","      - name: Install Java 17 (Amazon Corretto)","        run: |","          wget https://corretto.aws/downloads/latest/amazon-corretto-17-x64-linux-jdk.deb","          sudo dpkg -i amazon-corretto-17-x64-linux-jdk.deb","          java --version"],"id":17}],[{"start":{"row":34,"column":0},"end":{"row":35,"column":0},"action":"remove","lines":["",""],"id":18},{"start":{"row":33,"column":0},"end":{"row":34,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":0,"column":0},"end":{"row":87,"column":0},"action":"remove","lines":["name: Django CI/CD to Elastic Beanstalk","","on:","  push:","    branches:","      - main","","jobs:","","  # ============================================================","  # 1️⃣ PREBUILD STAGE","  # ============================================================","  prebuild:","    runs-on: ubuntu-latest","","    steps:","      - name: Checkout repo","        uses: actions/checkout@v3","","      - name: Set up Python","        uses: actions/setup-python@v4","        with:","          python-version: \"3.11\"","","      - name: Install dependencies","        run: |","          pip install --upgrade pip","          pip install -r requirements.txt","","      - name: Install OS dependencies","        run: |","          sudo apt-get update","          sudo apt-get install -y jq unzip wget","","","  # ============================================================","  # 4️⃣ PACKAGE ARTIFACT","  # ============================================================","  package:","    runs-on: ubuntu-latest","    needs: sonar_scan","","    steps:","      - uses: actions/checkout@v3","","      - name: Create ZIP for Elastic Beanstalk","        run: |","          zip -r deploy.zip . -x \"*.git*\" \".github/*\"","","      - name: Upload artifact","        uses: actions/upload-artifact@v4","        with:","          name: deploy-package","          path: deploy.zip","","","  # ============================================================","  # 5️⃣ DEPLOY TO ELASTIC BEANSTALK","  # ============================================================","  deploy:","    runs-on: ubuntu-latest","    needs: package","","    steps:","      - name: Download artifact","        uses: actions/download-artifact@v4","        with:","          name: deploy-package","","      - name: Configure AWS Credentials","        uses: aws-actions/configure-aws-credentials@v4","        with:","          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}","          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}","          aws-region: us-east-1","","      - name: Deploy to Elastic Beanstalk","        uses: einaregilsson/beanstalk-deploy@v21","        with:","          aws_access_key: ${{ secrets.AWS_ACCESS_KEY_ID }}","          aws_secret_key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}","          application_name: Devops-x23300841-eb","          environment_name: Devops-x23300841-eb-env","          region: us-east-1","          deployment_package: deploy.zip","          version_label: \"build-${{ github.run_number }}\"","          wait_for_deployment: true",""],"id":20},{"start":{"row":0,"column":0},"end":{"row":106,"column":0},"action":"insert","lines":["name: Django CI/CD to Elastic Beanstalk","","on:","  push:","    branches:","      - main","","jobs:","","  # ============================================================","  # 1️⃣ PREBUILD STAGE","  # ============================================================","  prebuild:","    runs-on: ubuntu-latest","","    steps:","      - name: Checkout repo","        uses: actions/checkout@v3","","      - name: Set up Python","        uses: actions/setup-python@v4","        with:","          python-version: \"3.11\"","","      - name: Install OS Dependencies","        run: |","          sudo apt-get update","          sudo apt-get install -y jq unzip wget","","","  # ============================================================","  # 2️⃣ BUILD STAGE","  # ============================================================","  build:","    runs-on: ubuntu-latest","    needs: prebuild","","    steps:","      - uses: actions/checkout@v3","","      - uses: actions/setup-python@v4","        with:","          python-version: \"3.11\"","","      - name: Install dependencies","        run: |","          pip install --upgrade pip","          pip install -r requirements.txt","","      - name: Collect static files","        run: |","          python manage.py collectstatic --noinput","","","  # ============================================================","  # 3️⃣ PACKAGE STAGE","  # ============================================================","  package:","    runs-on: ubuntu-latest","    needs: build","","    steps:","      - uses: actions/checkout@v3","","      - name: Create ZIP for Elastic Beanstalk","        run: |","          zip -r deploy.zip . -x \"*.git*\" \".github/*\"","","      - name: Upload package as artifact","        uses: actions/upload-artifact@v4","        with:","          name: deploy-package","          path: deploy.zip","","","  # ============================================================","  # 4️⃣ DEPLOYMENT STAGE","  # ============================================================","  deploy:","    runs-on: ubuntu-latest","    needs: package","","    steps:","      - name: Download artifact","        uses: actions/download-artifact@v4","        with:","          name: deploy-package","","      - name: Configure AWS Credentials","        uses: aws-actions/configure-aws-credentials@v4","        with:","          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}","          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}","          aws-region: us-east-1","","      - name: Deploy to Elastic Beanstalk","        uses: einaregilsson/beanstalk-deploy@v21","        with:","          aws_access_key: ${{ secrets.AWS_ACCESS_KEY_ID }}","          aws_secret_key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}","          application_name: Devops-x23300841-eb","          environment_name: Devops-x23300841-eb-env","          region: us-east-1","          deployment_package: deploy.zip","          version_label: \"build-${{ github.run_number }}\"","          wait_for_deployment: true",""]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":8,"column":0},"end":{"row":8,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1764938669711,"hash":"426dd7f78621a225624b8dd8a8f5b5ada6812532"}